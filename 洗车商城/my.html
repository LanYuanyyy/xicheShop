<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns="">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no"
    name="viewport" id="viewport" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <title>洗车商城</title>
  <script src="js/vue.min.js"></script>
  <script src="http://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
  <link rel="stylesheet" href="css/style.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@1.6/lib/index.css">
  <script src="https://cdn.jsdelivr.net/npm/vant@1.6/lib/vant.min.js"></script>
  <style>
    .van-popup {
      background-color: rgba(0, 0, 0, 0);
    }
  </style>
</head>

<body>
  <div class="body-container" id="app">
    <div class="my_infor">
      <a href="my_profile.html">
        <img :src="userInfo.image" alt="">
        <div class="info fl">
          <h1 class="eps">{{userInfo.usernanme}}</h1>
          <p class="eps">ID：{{userInfo.i_d}}</p>
        </div>
      </a>
    </div>
    <ul class="account_yue">
      <li class="first">
        <img src="images/icon18.png" alt="">
        <p>我的账户</p>
      </li>
      <li>
        <a @click='tobalance(userInfo.balance)'>
          <h1 class="eps">{{userInfo.balance}}</h1>
          <p>余额</p>
        </a>
      </li>
      <li>
        <a href="my_coupon.html">
          <h1 class="eps">{{userInfo.couponnums}}</h1>
          <p>优惠券</p>
        </a>
      </li>
      <li>
        <a @click='tobijingb(userInfo.score)'>
          <h1 class="eps">{{userInfo.score}}</h1>
          <p>必净币</p>
        </a>
      </li>
    </ul>
    <div class="my_order">
      <div class="my_title">
        <h1 class="fl">商品订单</h1>
        <a href="my_order.html" class="fr">全部订单</a>
      </div>
      <ul>
        <li><a href="my_order.html"><img src="images/order1.png">
            <p>待付款</p><em class="num" v-if='objectorder.nopay > 0'>{{objectorder.nopay}}</em>
          </a></li>
        <li><a href="my_order.html"><img src="images/order2.png">
            <p>待发货</p><em class="num" v-if='objectorder.nosend > 0'>{{objectorder.nosend}}</em>
          </a></li>
        <li><a href="my_order.html"><img src="images/order3.png">
            <p>待收货</p><em class="num" v-if='objectorder.noreceive > 0'>{{objectorder.noreceive}}</em>
          </a></li>
        <li><a href="my_order.html"><img src="images/order4.png">
            <p>已完成</p><em class="num" v-if='objectorder.complete'>{{objectorder.complete}}</em>
          </a></li>
        <li><a href="my_order.html"><img src="images/order5.png">
            <p>售后</p><em class="num" v-if='objectorder.returnnums > 0'>{{objectorder.returnnums}}</em>
          </a></li>
      </ul>
    </div>
    <div class="my_order">
      <div class="my_title">
        <a href="order.html">
          <h1>我的服务</h1>
        </a>
      </div>
      <ul>
        <li><a href="order.html">
            <h1 class="eps">{{serverorder.nopay}}</h1>
            <p>待付款</p>
          </a></li>
        <li><a href="order.html">
            <h1 class="eps">{{serverorder.nouse}}</h1>
            <p>待使用</p>
          </a></li>
        <li><a href="order.html">
            <h1 class="eps">{{serverorder.noeveluation}}</h1>
            <p>待评价</p>
          </a></li>
        <li><a href="order.html">
            <h1 class="eps">{{serverorder.returnnums}}</h1>
            <p>退款</p>
          </a></li>
      </ul>
    </div>
    <div class="mynav">
      <ul>
        <li @click='myShop'>
          <a href="javascript:;"><img src="images/mynav7.png">
            <p>我的店铺</p>
          </a></li>
      </ul>
    </div>
    <div class="mynav">
      <ul>
        <li><a href="news.html"><img src="images/mynav1.png">
            <p>消息中心</p>
          </a></li>
        <li><a href="my_collect_business.html"><img src="images/mynav2.png">
            <p>我的收藏</p>
          </a></li>
        <li><a href="my_evaluation.html"><img src="images/mynav3.png">
            <p>我的评价</p>
          </a></li>
        <li><a href="my_activity.html"><img src="images/mynav4.png">
            <p>我的活动</p>
          </a></li>
      </ul>
    </div>
    <div class="mynav">
      <ul>
        <li @click='ApplyForResidence'><a><img src="images/mynav5.png">
            <p>申请入驻</p>
          </a></li>
        <li><a href="my_set.html"><img src="images/mynav6.png">
            <p>设置中心</p>
          </a></li>
      </ul>
    </div>
    <nav class="nav_list">
      <ul>
        <li>
          <a href="index.html" class="nav1">首页</a>
        </li>
        <li>
          <a href="order.html" class="nav2">订单</a>
        </li>
        <li class="on">
          <a href="my.html" class="nav3">我的</a>
        </li>
      </ul>
    </nav>
    <div class="footline"></div>
    <van-popup v-model="isshow">
      <van-loading />
    </van-popup>
  </div>
</body>

</html>
<script src="js/jquery.min.js"></script>
<script src="js/template-web.js"></script>
<script src="js/common.js"></script>
<script src="js/md5.js"></script>
<script src="js/ran.util.js"></script>
<script src="js/app.js"></script>
<script src="js/axios.js"></script>
<script src="js/axios.conf.js"></script>
<script src="js/layer_mobile/layer.js"></script>
<script>
  new Vue({
    el: '#app',
    data: {
      uid: '',
      userInfo: '',
      objectorder: '',         //  商品订单
      serverorder: '',         //  服务订单
      secondhandstore: '',     //  是否开通二手店铺
      serverstore: '',         // 是否开通服务类店铺
      objectstore: '',
      isshow: false
    },
    created() {
      this.uid = getItem("uid");
      this.getUserHome()
    },
    methods: {
      async getUserHome() {
        this.isshow = true
        const res = await axios.get('/app/user/userhome', { params: { uid: this.uid } })
        setTimeout(() => {
          this.isshow = false
        }, 1000)
        const { data, code } = res.data
        console.log(data)
        this.userInfo = data.userinfo
        this.objectorder = data.objectorder
        this.serverorder = data.serverorder
        this.secondhandstore = data.secondhandstore
        this.serverstore = data.serverstore
        this.objectstore = data.objectstore
        console.log('个人信息', this.userInfo)
        console.log('是否开通二手店铺，我的店铺', this.secondhandstore)
        console.log('商品订单', this.objectorder)
        console.log('我的服务', this.serverorder)
        if (this.userInfo.i_d === '') {
          console.log('跳到注册手机号页码')
          location.href = 'register.html'
        }
        // console.log(res)
      },
      myShop() {
        if (this.secondhandstore == null) {
          location.href = 'my_store_wsq.html'
          console.log('去注册')
        } else if (this.secondhandstore.state === 1) {
          console.log('去二手商城管理页面')
          location.href = 'my_store.html'
        } else if (this.secondhandstore == 2) {
          console.log('正在审核')
        } else if (this.secondhandstore == 3) {
          console.log('审核被拒绝,去从新编辑页面')
        }
      },
      tobalance(balance) {
        // href = "my_acount.html"
        console.log(balance)
        location.href = `my_acount.html?balance=${balance}`
      },
      tobijingb(bj) {
        location.href = `my_bijingbi.html?bjb=${bj}`
      },
      ApplyForResidence() {
        console.log(this.serverstore instanceof Object)
        if (this.serverstore instanceof Object || this.objectstore instanceof Object) {
          location.href = `my_ruzhu.html?serverstore=${this.serverstore.state}&remark=${this.serverstore.remark}&objectstore=${this.objectstore.state}&objectremark=${this.objectstore.remark}`
        } else {
          location.href = `my_ruzhu.html?serverstore=${this.serverstore}&objectstore=${this.objectstore}`
        }
      }
    },
  })
</script>